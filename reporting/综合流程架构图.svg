<svg width="1600" height="900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-anchor: middle; }
      .layer-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .node-text { font-family: Arial, sans-serif; font-size: 11px; text-anchor: middle; }
      .legend-text { font-family: Arial, sans-serif; font-size: 10px; }
      .user-node { fill: #fff2cc; stroke: #d6b656; stroke-width: 2; }
      .business-node { fill: #f8cecc; stroke: #b85450; stroke-width: 2; }
      .tech-node { fill: #dae8fc; stroke: #6c8ebf; stroke-width: 2; }
      .auth-node { fill: #fff2cc; stroke: #d6b656; stroke-width: 2; }
      .api-node { fill: #e1d5e7; stroke: #9673a6; stroke-width: 2; }
      .ai-node { fill: #f8cecc; stroke: #b85450; stroke-width: 2; }
      .data-node { fill: #d5e8d4; stroke: #82b366; stroke-width: 2; }
      .obs-node { fill: #ffffff; stroke: #999999; stroke-width: 2; stroke-dasharray: 5,5; }
      .data-ellipse { fill: #ffe6cc; stroke: #d79b00; stroke-width: 2; }
      .flow-main { stroke: #1f497d; stroke-width: 3; fill: none; marker-end: url(#arrowhead-main); }
      .flow-tech { stroke: #82b366; stroke-width: 2; fill: none; marker-end: url(#arrowhead-tech); }
      .flow-data { stroke: #d79b00; stroke-width: 2; fill: none; marker-end: url(#arrowhead-data); }
      .flow-obs { stroke: #999999; stroke-width: 1; fill: none; stroke-dasharray: 5,5; marker-end: url(#arrowhead-obs); }
    </style>
    <marker id="arrowhead-main" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1f497d" />
    </marker>
    <marker id="arrowhead-tech" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#82b366" />
    </marker>
    <marker id="arrowhead-data" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#d79b00" />
    </marker>
    <marker id="arrowhead-obs" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#999999" />
    </marker>
  </defs>

  <!-- 标题 -->
  <text x="800" y="40" class="title">智能报告系统 - 端到端流程架构</text>

  <!-- 用户层背景 -->
  <rect x="80" y="80" width="1440" height="120" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" opacity="0.3"/>
  <text x="100" y="105" class="layer-title">用户层</text>
  
  <!-- 用户层节点 -->
  <rect x="120" y="130" width="140" height="60" rx="10" class="user-node"/>
  <text x="190" y="150" class="node-text">提出报告需求</text>
  <text x="190" y="165" class="node-text">(目标用户画像)</text>
  
  <rect x="300" y="130" width="140" height="60" rx="10" class="user-node"/>
  <text x="370" y="150" class="node-text">选择模板</text>
  <text x="370" y="165" class="node-text">补充数据</text>
  
  <rect x="660" y="130" width="140" height="60" rx="10" class="user-node"/>
  <text x="730" y="150" class="node-text">确认草稿</text>
  <text x="730" y="165" class="node-text">提供反馈</text>
  
  <rect x="1160" y="130" width="140" height="60" rx="10" class="user-node"/>
  <text x="1230" y="150" class="node-text">获取最终报告</text>
  <text x="1230" y="165" class="node-text">分享导出</text>

  <!-- 业务层背景 -->
  <rect x="80" y="220" width="1440" height="120" fill="#e1d5e7" stroke="#9673a6" stroke-width="2" opacity="0.3"/>
  <text x="100" y="245" class="layer-title">业务层</text>
  
  <!-- 业务层节点 -->
  <rect x="480" y="270" width="140" height="60" rx="10" class="business-node"/>
  <text x="550" y="290" class="node-text">需求分析</text>
  <text x="550" y="305" class="node-text">模板匹配</text>
  
  <rect x="840" y="270" width="140" height="60" rx="10" class="business-node"/>
  <text x="910" y="290" class="node-text">内容审核</text>
  <text x="910" y="305" class="node-text">规范校验</text>
  
  <rect x="1340" y="270" width="140" height="60" rx="10" class="business-node"/>
  <text x="1410" y="290" class="node-text">发布归档</text>
  <text x="1410" y="305" class="node-text">权限管理</text>

  <!-- 技术层背景 -->
  <rect x="80" y="360" width="1440" height="200" fill="#d5e8d4" stroke="#82b366" stroke-width="2" opacity="0.3"/>
  <text x="100" y="385" class="layer-title">技术层</text>
  
  <!-- 技术层节点 -->
  <rect x="120" y="410" width="160" height="80" rx="10" class="tech-node"/>
  <text x="200" y="430" class="node-text">Web前端</text>
  <text x="200" y="445" class="node-text">Vite+React+Tailwind</text>
  <text x="200" y="460" class="node-text">用户界面</text>
  
  <rect x="320" y="410" width="160" height="80" rx="10" class="auth-node"/>
  <text x="400" y="430" class="node-text">鉴权服务</text>
  <text x="400" y="445" class="node-text">Supabase Auth</text>
  <text x="400" y="460" class="node-text">身份验证</text>
  
  <rect x="520" y="410" width="160" height="80" rx="10" class="api-node"/>
  <text x="600" y="430" class="node-text">BFF/API层</text>
  <text x="600" y="445" class="node-text">业务编排</text>
  <text x="600" y="460" class="node-text">权限校验</text>
  
  <rect x="720" y="410" width="160" height="80" rx="10" class="ai-node"/>
  <text x="800" y="430" class="node-text">AI推理引擎</text>
  <text x="800" y="445" class="node-text">模板渲染</text>
  <text x="800" y="460" class="node-text">异步任务队列</text>
  
  <rect x="920" y="410" width="160" height="80" rx="10" class="data-node"/>
  <text x="1000" y="430" class="node-text">数据存储</text>
  <text x="1000" y="445" class="node-text">Postgres</text>
  <text x="1000" y="460" class="node-text">结构化数据</text>
  
  <rect x="1120" y="410" width="160" height="80" rx="10" class="data-node"/>
  <text x="1200" y="430" class="node-text">对象存储</text>
  <text x="1200" y="445" class="node-text">报告/附件/PDF</text>
  <text x="1200" y="460" class="node-text">导出服务</text>
  
  <rect x="1320" y="410" width="160" height="80" rx="10" class="obs-node"/>
  <text x="1400" y="430" class="node-text">可观测性</text>
  <text x="1400" y="445" class="node-text">日志/指标/告警</text>
  <text x="1400" y="460" class="node-text">审计追踪</text>

  <!-- 数据流层背景 -->
  <rect x="80" y="580" width="1440" height="120" fill="#f8f8f8" stroke="#666666" stroke-width="2" opacity="0.3"/>
  <text x="100" y="605" class="layer-title">数据流</text>
  
  <!-- 数据流节点 -->
  <ellipse cx="200" cy="650" rx="50" ry="30" class="data-ellipse"/>
  <text x="200" y="645" class="node-text">用户输入</text>
  <text x="200" y="660" class="node-text">需求数据</text>
  
  <ellipse cx="500" cy="650" rx="50" ry="30" class="data-ellipse"/>
  <text x="500" y="645" class="node-text">AI分析</text>
  <text x="500" y="660" class="node-text">结果数据</text>
  
  <ellipse cx="800" cy="650" rx="50" ry="30" class="data-ellipse"/>
  <text x="800" y="645" class="node-text">草稿</text>
  <text x="800" y="660" class="node-text">反馈数据</text>
  
  <ellipse cx="1100" cy="650" rx="50" ry="30" class="data-ellipse"/>
  <text x="1100" y="645" class="node-text">最终报告</text>
  <text x="1100" y="660" class="node-text">导出数据</text>
  
  <ellipse cx="1400" cy="650" rx="50" ry="30" class="data-ellipse"/>
  <text x="1400" y="645" class="node-text">审计</text>
  <text x="1400" y="660" class="node-text">追踪数据</text>

  <!-- 主要流程连线 -->
  <path d="M 190 190 Q 190 230 550 270" class="flow-main"/>
  <path d="M 370 190 Q 370 350 800 410" class="flow-main"/>
  <path d="M 730 190 Q 730 230 910 270" class="flow-main"/>
  <path d="M 1230 190 Q 1230 230 1410 270" class="flow-main"/>

  <!-- 技术层内部连线 -->
  <path d="M 280 450 L 320 450" class="flow-tech"/>
  <path d="M 480 450 L 520 450" class="flow-tech"/>
  <path d="M 680 450 L 720 450" class="flow-tech"/>
  <path d="M 880 450 L 920 450" class="flow-tech"/>
  <path d="M 1080 450 L 1120 450" class="flow-tech"/>
  <path d="M 1280 450 L 1320 450" class="flow-obs"/>

  <!-- 数据流连线 -->
  <path d="M 250 650 L 450 650" class="flow-data"/>
  <path d="M 550 650 L 750 650" class="flow-data"/>
  <path d="M 850 650 L 1050 650" class="flow-data"/>
  <path d="M 1150 650 L 1350 650" class="flow-data"/>

  <!-- 图例 -->
  <rect x="80" y="730" width="600" height="120" fill="#f5f5f5" stroke="#666666" stroke-width="2"/>
  <text x="100" y="755" class="layer-title">图例</text>
  
  <line x1="120" y1="780" x2="200" y2="780" class="flow-main"/>
  <text x="210" y="785" class="legend-text">用户交互流程</text>
  
  <line x1="320" y1="780" x2="400" y2="780" class="flow-tech"/>
  <text x="410" y="785" class="legend-text">技术组件调用</text>
  
  <line x1="520" y1="780" x2="600" y2="780" class="flow-data"/>
  <text x="610" y="785" class="legend-text">数据流转</text>
  
  <line x1="120" y1="810" x2="200" y2="810" class="flow-obs"/>
  <text x="210" y="815" class="legend-text">可观测性</text>
  
  <rect x="320" y="800" width="80" height="20" class="user-node"/>
  <text x="410" y="815" class="legend-text">用户操作</text>
  
  <rect x="520" y="800" width="80" height="20" class="business-node"/>
  <text x="610" y="815" class="legend-text">业务流程</text>

</svg>